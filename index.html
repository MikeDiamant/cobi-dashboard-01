<!DOCTYPE html>
<html>

    <head>
        <meta charset="utf-8">
        <title>COBI BK Dashboard</title>

        <meta name="viewport" content="initial-scale=1, maximum-scale=1">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">

        <link href="css/cobi-style.css" rel="stylesheet">
        <link href="css/style.css" rel="stylesheet">

    </head>

    <body>

        <div id="container"></div>

        <div id="speed">-</div>
        <div id="cadence">-</div>

        <div id="version"></div>

        <script src="https://cdn.cobi.bike/cobi.js/0.34.1/cobi.js"></script>
        <script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
        <script src="https://cdn.rawgit.com/konvajs/konva/1.7.2/konva.min.js"></script>

        <script src="lib/BkDashboard.js"></script>

        <script>

            $(document).ready(
                function () {

                    COBI.init('token â€” can by anything right now');

                    let BkD = new BkDashboard('container', window.innerWidth, window.innerHeight);

                    BkD.initView();

                    BkD.initAverageSpeedView();
                    BkD.initAverageCadenceView();

                    BkD.initSpeedCheck();
                    BkD.initCadenceCheck();

                    COBI.rideService.speed.subscribe(
                        function (value) {
                            BkD.updateCurrentSpeedView(value * 3.6);
                        }
                    );

                    COBI.tourService.averageSpeed.subscribe(
                        function (value) {
                            BkD.updateAverageSpeedView(value * 3.6);
                        }
                    );

                    COBI.rideService.cadenceAvailability.subscribe(
                        function (value) {
                            console.log('cadence available: ' + value);
                        }
                    );

                    COBI.rideService.cadence.subscribe(
                        function (value) {
                            BkD.updateCurrentCadenceView(value);
                        }
                    );

                }
            );

        </script>

    </body>

</html>
